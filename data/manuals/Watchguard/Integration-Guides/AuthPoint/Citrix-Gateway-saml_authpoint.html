<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Help_Center_Side_Nav" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-toc-path="Self-Help Tools|Integration Guides|AuthPoint" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Expires" content="3600" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="120x120" href="../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" /><title>Citrix Gateway SAML Integration with AuthPoint</title>
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/help_(en-US).css" rel="stylesheet" type="text/css" />
        <link rel="apple-touch-icon" sizes="120x120" href="../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-T3SCZC3');/* ]]> */</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-left" role="navigation" id="offCanvas" data-off-canvas="" data-position="left" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 979px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../en-US/_intro/home.html" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div id="cover">
                                    </div>
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T3SCZC3" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="6" data-mc-toc="True"><span class="MCBreadcrumbsPrefix"> </span>
                                        </div>
                                    </div>
                                    <div role="main" id="mc-main-content">
                                        <h1><a name="aanchor1056"></a>
                                            <MadCap:concept term="Self-Help Tools" /><a name="aanchor1057"></a>
                                            <MadCap:concept term="AuthPoint" />Citrix Gateway SAML Integration with AuthPoint</h1>
                                        <h2>Deployment Overview</h2>
                                        <p>This document describes how to set up multi-factor authentication (MFA) for Citrix Gateway with AuthPoint as an identity provider. Citrix Gateway must already be configured and deployed before you set up MFA with AuthPoint.</p>
                                        <p>Citrix Gateway can be configured to support MFA in several modes. For this integration, we set up SAML with AuthPoint. To configure RADIUS authentication for Citrix Gateway, see <a href="Citrix-Gateway-radius_authpoint.html" class="MCXref xref">Citrix Gateway RADIUS Integration with AuthPoint</a>.</p>
                                        <p>This integration was tested with NS13.1: Build 12.11.nc of Citrix ADC (Citrix Gateway is a part of Citrix ADC).</p>
                                        <h3>Citrix Gateway SAML Authentication Data Flow with AuthPoint</h3>
                                        <p>AuthPoint communicates with various cloud-based services and service providers with the SAML protocol. This diagram shows the data flow of an MFA transaction for a Citrix Gateway.</p>
                                        <p class="img">
                                            <img src="_images/Citrix Netscaler SAML/Citrix-MFA-Data-Flow.png" style="max-height: auto;max-width: 100%;" alt="Diagram that shows the data flow of an MFA transaction for a SAML resource with the push authentication method." />
                                        </p>
                                        <h2>Before You Begin</h2>
                                        <p>Before you begin these procedures, make sure that:</p>
                                        <ul style="list-style-type: square;">
                                            <li>End-users able to configure Citrix ADC </li>
                                            <li>End-users able to login Citrix Gateway using local AD user<ul style="list-style-type: square;font-style: italic;"><li>Note: there needs many pre-requisites before integrating with AuthPoint. We suggest to refer to the configurtion of login Citrix Gateway using AD user, and make sure AD user could log in successfully. In that way we can confirm all the pre-setups on Citrix side are done before move to next step</li></ul></li>
                                            <li>A token is assigned to a user in AuthPoint</li>
                                            <li>You have an <a href="#" class="MCTextPopup popup popupHead popupHeaddefinition">AuthPoint identity provider (IdP) certificate<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody" aria-hidden="true"><span class="MCTextPopupArrow"> </span>An AuthPoint IdP certificate is required for SAML authentication.</span></a> (go to <a href="../../en-US/authpoint/certificates.html" class="MCXref xref">Certificate Management</a>)</li>
                                        </ul>
                                        <h2>Configure Citrix Gateway</h2>
                                        <p>To start, you must download the metadata file and the certificate file from the Resources page in the AuthPoint management UI. Once you have those, you can configure Citrix Gateway.</p>
                                        <p style="page-break-before: avoid;page-break-after: avoid;">From the WatchGuard Cloud web UI:</p>
                                        <ol style="page-break-after: avoid;" start="1">
                                            <li value="1">From the navigation menu, select <b>Configure &gt; AuthPoint</b>. If you have a Service Provider account, you must first pivot to your Subscriber view.</li>
                                            <li value="2">Select <b>Resources</b>.</li>
                                            <li value="3">Click <b>Certificate</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="../../__Templates/images/apt_resources.png" style="height: auto;width: 750px;max-width: 100%;max-height: auto;" class="hasBorder" />
                                        </p>
                                        <ol style="page-break-after: avoid;" start="4" data-mc-continue="true">
                                            <li value="4"><a name="AuthPointCert"></a>Next to AuthPoint certificate you will associate with your resource, click <img src="_images/menu_icon.png" style="height: 13px;width: auto;" /> ,select <b>Download Metadata</b> and <b>Download Certificate</b>. We recommend that you choose the certificate with the latest expiration date. If you do not have a certificate, or if all of your certificates have expired, click <b>Add Certificate</b> and use the newly created certificate. For more information, see <a href="../../en-US/authpoint/certificates.html" class="MCXref xref">Certificate Management</a>.<p class="Note">The AuthPoint metadata provides your resource, in this case Citrix Gateway, with information necessary to identify AuthPoint as a trusted identity provider.</p></li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="../../__Templates/images/apt_cert-mgmt_cert-menu.PNG" style="height: auto;width: 750px;max-width: 100%;max-height: auto;" class="hasBorder" />
                                        </p>
                                        <ol start="5" style="page-break-after: avoid;" data-mc-continue="true">
                                            <li value="5">Log in to the Citrix ADC admin interface as an administrator.</li>
                                            <li value="6">Select the <b>Configuration</b> tab.</li>
                                            <li value="7"> Navigate to <b>Traffic Management &gt;&#160;SSL &gt; Certificates &gt; CA Certificates</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/2.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the CA Certificates" />
                                        </p>
                                        <ol start="8" style="page-break-after: avoid;" data-mc-continue="true">
                                            <li value="8">Click <b>Install</b>.</li>
                                            <li value="9">In the <b>Certificate-Key Pair Name</b> text box, type an easily identifiable name.</li>
                                            <li value="10">For <b>Certificate File Name</b>, click <b>Choose File</b> and upload the CA certificate file you get.</li>
                                            <li value="11">Click <b>Install</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/3.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the CA Certificates" />
                                        </p>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/15.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the CA Certificates" />
                                        </p>
                                        <ol start="12" style="page-break-after: avoid;" data-mc-continue="true">
                                            <li value="12">Select <b>Citrix Gateway &gt; Policies &gt; Authentication &gt; SAML</b>.</li>
                                            <li value="13">Select the <b>Servers</b> tab.</li>
                                            <li value="14">Click <b>Add</b>.</li>
                                            <li value="15">In the <b>Name</b> text box, type an easily identifiable name. In our example, we type <span class="Input">AuthPoint</span>.</li>
                                            <li value="16">Clear the <b>Import Metadata</b> check box.</li>
                                            <li value="17">In the <b>Redirect URL</b> text box, type the <b>SingleSignOnService Location</b> value from the AuthPoint metadata file.</li>
                                            <li value="18">In the <b>Single Logout URL</b> text box, type the <b>SingleLogoutService Location</b> value from the AuthPoint metadata file.</li>
                                            <li value="19">From the <b>SAML Binding</b> drop-down list, select  <b>POST</b>.</li>
                                            <li value="20">From the <b>Logout Binding</b> drop-down list, select  <b>POST</b>.</li>
                                            <li value="21">From the <b>IDP Certificate Name</b> drop-down list, select the certificate you got from AuthPoint and installed to Citrix ADC.</li>
                                            <li value="22">In the <b>User Field</b> text box, type <span class="Input">Name ID</span>.</li>
                                            <li value="23">From the <b>Signing Certificate Name</b> drop-down list, select a certificate that can be trusted by Citrix.</li>
                                            <li value="24">In the <b>Issuer Name</b> text box, type the name used to log in to the Citrix Gateway Virtual Server.</li>
                                            <li value="25">From the <b>Reject Unsigned Assertion</b> drop-down list, select  <b>ON</b>.</li>
                                            <li value="26">For <b>Signature Algorithm</b>, select <b>RSA-SHA256</b>.</li>
                                            <li value="27">For <b>Digest Method</b>, select <b>SHA256</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/4.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the creat authentication SAML server" />
                                        </p>
                                        <ol start="29" style="page-break-after: avoid;" data-mc-continue="true">
                                            <li value="28">Click <b>Create</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/5.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the creat authentication SAML server" />
                                        </p>
                                        <ol start="31" style="page-break-after: avoid;" data-mc-continue="true">
                                            <li value="29">On the <b>SAML</b> page, select the <b>Policies</b> tab. Click <b>Add</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/6.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the creat authentication SAML Policies" />
                                        </p>
                                        <ol start="32" style="page-break-after: avoid;" data-mc-continue="true">
                                            <li value="30">In the <b>Name</b> text box, type  an easily identifiable name. In our example, we type <span class="Input">AuthPoint_Policy</span>.</li>
                                            <li value="31">From the <b>Server</b> drop-down list, select your SAML server.</li>
                                            <li value="32">Under <b>Expression</b>, from the second <b>Select</b> drop-down list, select <b>ns_true</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/7.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the creat authentication SAML Policies" />
                                        </p>
                                        <ol start="35" style="page-break-after: avoid;" data-mc-continue="true">
                                            <li value="33">Click <b>Create</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/8.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the creat authentication SAML Policies" />
                                        </p>
                                        <p class="Note">If you get a warning about classic authentication policies, you can click OK to ignore it.</p>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/10.png" style="max-height: auto;max-width: 90%;" />
                                        </p>
                                        <ol start="36" style="page-break-after: avoid;" data-mc-continue="true">
                                            <li value="34">Navigate to <b>Citrix Gateway &gt; Virtual Servers</b>.</li>
                                            <li value="35">Select the virtual servers you created. For more information about how to create virtual servers, see the Citrix documentation.</li>
                                            <li value="36">Click <b>Edit</b>.</li>
                                            <li value="37">Next to <b>Basic Authentication</b>, click <b>+</b>.</li>
                                            <li value="38">From the <b>Choose Policy</b> drop-down list, select <b>SAML</b>.</li>
                                            <li value="39">From the <b>Choose Type</b> drop-down list, select <b>Primary</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/9.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the add authentication type" />
                                        </p>
                                        <ol start="42" style="page-break-after: avoid;" data-mc-continue="true">
                                            <li value="40">Click <b>Continue</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/11.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the add authentication type" />
                                        </p>
                                        <ol start="43" style="page-break-after: avoid;" data-mc-continue="true">
                                            <li value="41">In the <b>Select Policy</b> section, click <b>&gt;</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/12.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the add authentication type" />
                                        </p>
                                        <ol start="44" style="page-break-after: avoid;" data-mc-continue="true">
                                            <li value="42">Select your SAML policy. Click <b>Select</b>.</li>
                                            <li value="43">Leave the default settings.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/13.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the add authentication type" />
                                        </p>
                                        <ol start="46" style="page-break-after: avoid;" data-mc-continue="true">
                                            <li value="44">Click <b>Bind</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/14.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the add authentication type" />
                                        </p>
                                        <ol start="47" style="page-break-after: avoid;" data-mc-continue="true">
                                            <li value="45">On the <b>VPN Virtual Server</b> configuration page, click <b>Done</b>.</li>
                                            <li value="46">Navigate to <b>Citrix Gateway &gt; Policies &gt; Authentication &gt; SAML</b>.</li>
                                            <li value="47">Select the <b>Servers</b> tab.</li>
                                            <li value="48">Select your SAML server and then click <b>Export SAML Metadata</b>.</li>
                                            <li value="49">Select your VPN server and click <b>Export</b>.</li>
                                            <li value="50">On the metadata page, find and copy the <b>entityID</b>, <b>Assertion Consumer Service</b> and <b>SingleLogoutService</b> values. You need these values to create a SAML resource in AuthPoint.</li>
                                        </ol>
                                        <h2>Configure AuthPoint</h2>
                                        <p style="page-break-after: always;page-break-before: avoid;">Before AuthPoint can receive authentication requests from Citrix Gateway, you must add a SAML <a href="#" class="MCTextPopup popup popupHead popupHeaddefinition">resource<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody" aria-hidden="true"><span class="MCTextPopupArrow"> </span>In AuthPoint, resources are the applications and services that your users connect to.</span></a> in AuthPoint. You must also create an <a href="#" class="MCTextPopup popup popupHead popupHeaddefinition">authentication policy<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody" aria-hidden="true"><span class="MCTextPopupArrow"> </span>Authentication policies specify which resources users can authenticate to and which authentication methods they can use (Push, QR code, and OTP).</span></a> for the Citrix Gateway resource to determine which users can authenticate and log in to Citrix Gateway and which authentication methods they can use (Push, QR code, and OTP).</p>
                                        <h3>Add a SAML Resource in AuthPoint</h3>
                                        <p>From the AuthPoint management UI:</p>
                                        <ol>
                                            <li value="1">From the navigation menu, select <b>Resources</b>.
 Click <b>Add Resource</b>.<br /><span class="NumContinued">The Add Resource page opens.</span><![CDATA[        
        ]]></li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="../../__Templates/images/apt_resources.png" style="height: auto;max-width: 100%;max-height: auto;width: 750px;" class="hasBorder" />
                                        </p>
                                        <ol data-mc-continue="true">
                                            <li value="2">From the <b>Type</b> drop-down list, select <b>SAML</b>.<br /><span class="NumContinued">Additional fields appear.</span></li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="../../__Templates/images/apt_resources_add.png" />
                                        </p>
                                        <ol start="3">
                                            <li value="3">On the <b>SAML</b> page, in the <b>Name</b> text box, type a name for this resource.</li>
                                            <li value="4">From the <b>Application Type</b> drop-down list, select <b>Citrix Gateway</b>.</li>
                                            <li value="5">In the <b>Service Provider Entity ID</b> text box, type the <b>entityID</b> value from the Citrix Gateway matadata page.</li>
                                            <li value="6">In the <b>Assertion Consumer Service</b> text box, type the <b>Assertion Consumer Service</b> value from the Citrix Gateway matadata page. Format https://<b style="font-style: italic;">Citrix Gateway FQDN</b>/cgi/samlauth.</li>
                                            <li value="7">From the <b>User ID sent on redirection to service provider</b> drop-down list, select  <b>User Name</b>.</li>
                                            <li value="8">In the <b>Logout URL</b> text box, type the <b>Assertion Consumer Service</b> value from the Citrix Gateway matadata page. Format https://<b style="font-style: italic;">Citrix Gateway FQDN</b>/cgi/tmlogout.</li>
                                            <li value="9">From the <b>Signature Method</b> drop-down list, select <b>SHA-256</b>.</li>
                                            <li value="10">From the <b>AuthPoint Certificate</b> drop-down list, select the certificate to associate with your resource. This must be the same certificate that you downloaded the metadata for in the previous section.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/AuthPoint SAML Resources 2.png" style="max-height: auto;max-width: 90%;" />
                                        </p>
                                        <ol start="11">
                                            <li value="11">Click <b>Save</b>.</li>
                                        </ol>
                                        <h3>Add a Group in AuthPoint</h3>
                                        <p style="page-break-after: avoid;page-break-before: avoid;">You must have at least one user group in AuthPoint to configure MFA. If you already have a group, you do not have to add another group.</p>
                                        <p>To add a WatchGuard Cloud-hosted group to the WatchGuard Cloud Directory:</p>
                                        <ol>
                                            <li value="1">Go to <b>Configure &gt;&#160;Directories and Domain Services</b>.</li>
                                            <li value="2">Click the WatchGuard Cloud Directory domain name. If you have not yet added the WatchGuard Cloud Directory, click <b>Add Authentication Domain</b> and select the WatchGuard Cloud Directory.<br /><span class="NumContinued">The New Group page appears.</span></li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="../../__Templates/images/auth_domains.png" alt="Screenshot that shows the Directories and Domain Services page." />
                                        </p>
                                        <ol data-mc-continue="true">
                                            <li value="3">In the <b>Groups</b> tab, click <b>Add Group</b>.</li>
                                            <li value="4">In the <b>Group Name</b> text box, type a descriptive name for the group.</li>
                                            <li value="5">(Optional) In the <b>Description</b> text box, type a description of the group.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="../../__Templates/images/auth_domain_add_group.png" alt="Screen shot of the Add Group page." />
                                        </p>
                                        <ol data-mc-continue="true">
                                            <li value="6">Click <b>Save</b>.<br /><span class="NumContinued">Your group is added to the WatchGuard Cloud Directory and to AuthPoint.</span></li>
                                        </ol>
                                        <h3>Add an Authentication Policy to AuthPoint</h3>
                                        <p>Authentication policies specify which resources users can authenticate to and which authentication methods they can use (Push, QR code, and OTP).</p>
                                        <p>You must have at least one authentication policy in AuthPoint that includes the Citrix Gateway resource. If you already have authentication policies, you do not have to create a new authentication policy. You can add this resource to your existing authentication policies.</p>
                                        <p class="Note">Users that do not have an authentication policy for a specific resource cannot authenticate to log in to that resource.</p>
                                        <p>To configure an authentication policy:</p>
                                        <ol style="page-break-after: avoid;">
                                            <li value="1">From the navigation menu, select <b>Authentication Policies</b>.</li>
                                            <li value="2">Click <b>Add Policy</b>.
</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="../../__Templates/images/apt_policies_empty.png" style="max-height: auto;max-width: 100%;height: auto;width: 850px;" alt="Screenshot of the Add Policy button on the Authentication Policies page." />
                                        </p>
                                        <ol style="page-break-after: avoid;page-break-inside: avoid;" data-mc-continue="true">
                                            <li value="3">Type a name for this policy.</li>
                                            <li value="4">From the <b>Select the Authentication Options</b> drop-down list, select <b>Authentication Options</b> and select which authentication options users can choose from when they authenticate.<p class="Note">For SAML resources, if you select more than one authentication option, users must select one of the available options when they authenticate. For example, if you select OTP and Push, users can choose to type their OTP or approve a push to authenticate. You cannot require that they do both.</p></li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="../../__Templates/images/apt_policies_add_auth-options.png" style="height: auto;max-width: 100%;max-height: auto;width: 600px;" />
                                        </p>
                                        <ol style="page-break-after: avoid;page-break-inside: avoid;" data-mc-continue="true">
                                            <li value="5">Select which groups this policy applies to. You can select more than one group. To configure this policy to apply to all groups, select <b>All Groups</b>.</li>
                                            <li value="6">Select the resource that you created in the previous section. If you want this policy to apply to additional resources, select each resource this policy applies to. To configure this policy to apply to all resources, select <b>All Resources</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="../../__Templates/images/apt_policy_groups-resources.png" style="max-width: 100%;max-height: auto;height: auto;width: 600px;" alt="Screenshot of the Add Policy page with the groups and resources selected" />
                                        </p>
                                        <ol style="page-break-after: avoid;page-break-inside: avoid;" data-mc-continue="true">
                                            <li value="7">
                                                <p>(Optional) If you have configured policy objects such as a Network Location, select which policy objects apply to this policy. When you add a policy object to a policy, the policy only applies to user authentications that are the same as the conditions of the policy objects. For example, if you add a Network Location to a policy, the policy only applies to user authentications that come from that Network Location. Users who only have a policy that includes a Network Location do not get access to the resource when they authenticate outside of that Network Location (because they do not have a policy that applies, not because authentication is denied).</p>
                                                <p class="Note">If you configure policy objects, we recommend that you create a second policy for the same groups and resources without the policy objects. The policy with the policy objects should have a higher priority.</p>
                                            </li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="../../__Templates/images/apt_policies_select_policy-objects.png" style="max-height: auto;max-width: 100%;height: auto;width: 600px;" alt="Screenshot of the Policy Objects drop-down list." />
                                        </p>
                                        <ol style="page-break-after: avoid;page-break-inside: avoid;" data-mc-continue="true">
                                            <li value="8">Click <b>Save</b>.
<br /><span class="NumContinued">Your policy is created and added to the end of the policy list.
</span><p class="Note">When you create a new policy, we recommend that you review the order of your policies. AuthPoint always adds new policies to the end of the policy list.</p></li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="../../__Templates/images/apt_policies_save-policy.png" style="max-height: auto;max-width: 100%;height: auto;width: 600px;" alt="Screenshot of the Save button on the Add Policy page." />
                                        </p>
                                        <p style="page-break-before: avoid;">Before you assign users to a group, you must add the users to AuthPoint. You can manually add user accounts or import user accounts from an external user database. For more information on how to add user accounts, see <a href="https://www.watchguard.com/help/docs/help-center/en-US/Content/en-US/authpoint/add_user_accounts.html">Add User Accounts</a>.</p>
                                        <h2>Test the Integration</h2>
                                        <p style="page-break-after: avoid;page-break-before: avoid;">To test the integration of AuthPoint and the configuration of Citrix Gateway, you can authenticate with a mobile token on your mobile device. You can choose any method (one-time password, QR code, or push).</p>
                                        <p style="page-break-after: avoid;page-break-before: avoid;">In this example, we show the push authentication method (users receive a push notification in the mobile app that they must approve to authenticate).</p>
                                        <ol start="1">
                                            <li value="1">In a web browser, go to the Citrix Gateway virtual server login URL.<br /><span class="NumContinued">You see the AuthPoint authentication page.</span></li>
                                            <li value="2">Type your email address or AuthPoint user name. Click <b>Next</b>.</li>
                                            <li value="3">If required, in the <b>Password</b> text box, type your password.</li>
                                            <li value="4">For the authentication method, select <b>Send Push</b>.</li>
                                            <li value="5">Approve the authentication request that is sent to your mobile device.<br /><span class="NumContinued" style="font-style: italic;">You are logged in to Citrix Gateway virtual server.</span></li>
                                        </ol>
                                        <p class="Note">When you log in, the Citrix Gateway UI appears empty because there are no products bound after Citrix Gateway. You can bind Citrix Gateway with other Citrix products, such as XenApp and XenDesktop.</p>
                                        <p class="img_indent_1">
                                            <img src="_images/Citrix Netscaler SAML/1.png" style="max-height: auto;max-width: 90%;" alt="Screen shot of the add authentication type" />
                                        </p>
                                    </div>
                                    <p class="FooterTop"><a href="../../en-US/Fireware/support/doc_feedback.html">Give Us Feedback</a>&#160;&#160;●&#160;&#160;
            <a href="../../en-US/Fireware/support/getsupport.html">Get Support</a>&#160;&#160;●&#160;&#160;
            <a href="https://www.watchguard.com/wgrd-help/documentation/overview" target="_blank">All Product Documentation</a>&#160;&#160;●&#160;&#160;
            <a href="https://techsearch.watchguard.com/" target="_blank">Technical Search</a></p>
                                    <p class="Footer">© <span class="mc-variable Global.CurrentYear variable">2024</span> WatchGuard Technologies, Inc. All rights reserved. WatchGuard and the WatchGuard logo are registered trademarks or trademarks of WatchGuard Technologies in the United States and other countries. Various other trademarks are held by their respective owners.</p>
                                    <p class="Footer">&#160;</p>
                                    <div id="expand-collapse" title="Expand/collapse navigation" class="collapse">
                                    </div>
                                    <script src="../../Resources/MasterPages/scripts/expand-collapse.js">
                                    </script>
                                    <script src="../../Resources/MasterPages/scripts/cover-hide.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>