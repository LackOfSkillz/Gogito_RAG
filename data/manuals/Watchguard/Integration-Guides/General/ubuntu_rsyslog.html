<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Help_Center_Side_Nav" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-toc-path="Self-Help Tools|Integration Guides|Fireware" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Expires" content="3600" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="120x120" href="../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" /><title>Ubuntu Rsyslog Integration Overview</title>
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/help_(en-US).css" rel="stylesheet" type="text/css" />
        <link href="../../Resources/TableStyles/headertop.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="apple-touch-icon" sizes="120x120" href="../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-T3SCZC3');/* ]]> */</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-left" role="navigation" id="offCanvas" data-off-canvas="" data-position="left" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 979px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../en-US/_intro/home.html" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div id="cover">
                                    </div>
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T3SCZC3" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="6" data-mc-toc="True"><span class="MCBreadcrumbsPrefix"> </span>
                                        </div>
                                    </div>
                                    <div role="main" id="mc-main-content">
                                        <h1 id="UbuntuRsyslogIntegrationOverview" data-magellan-target="UbuntuRsyslogIntegrationOverview"><a name="aanchor1302"></a>
                                            <MadCap:concept term="Self-Help Tools" />Ubuntu Rsyslog Integration Overview</h1>
                                        <p>Ubuntu is a Linux distribution that includes various daemons, services, and utilities. One of the available services is Rsyslog, that builds on the features available in Syslog logging. This document describes the steps to integrate Ubuntu Rsyslog logging with your WatchGuard Firebox to view and search your Firebox Syslog messages.</p>
                                        <h2 id="Contents" data-magellan-target="Contents">Contents</h2>
                                        <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 980px)" class="nocontent menu _Skins_Help_Center_Menu_Slide mc-component">
                                            <li class="tree-node"><a href="#UbuntuRsyslogIntegrationOverview">Ubuntu Rsyslog Integration Overview</a>
                                            </li>
                                            <li>
                                                <ul>
                                                    <li class="tree-node"><a href="#Contents">Contents</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#IntegrationSummary">Integration Summary </a>
                                                    </li>
                                                    <li class="tree-node"><a href="#IntegrationTopology">Integration Topology</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#BeforeYouBegin">Before You Begin</a>
                                                    </li>
                                                    <li>
                                                        <ul>
                                                            <li class="tree-node"><a href="#ConfigureStaticIPAddressforUbuntuServer">Configure Static IP&#160;Address for Ubuntu Server</a>
                                                            </li>
                                                            <li class="tree-node"><a href="#FindtheFireboxName">Find the Firebox Name</a>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li class="tree-node"><a href="#ConfiguretheFirebox">Configure the Firebox</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#ConfigureRsyslogLoggingonUbuntuServer">Configure Rsyslog Logging on Ubuntu Server</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#TesttheIntegration">Test the Integration</a>
                                                    </li>
                                                    <li>
                                                        <ul>
                                                            <li class="tree-node"><a href="#TroubleshootRsyslogSetup">Troubleshoot Rsyslog Setup</a>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li class="tree-node"><a href="#SearchRsyslogOutput">Search Rsyslog Output</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <div class="summary-left">
                                            <h2 id="IntegrationSummary" data-magellan-target="IntegrationSummary">Integration Summary </h2>
                                            <p>The hardware and software used to complete the steps outlined in this document include:</p>
                                            <ul>
                                                <li>WatchGuard Firebox device installed with Fireware v12.10.4</li>
                                                <li>Ubuntu Server 24.04 LTS</li>
                                                <li>Rsyslog 8.2312.0</li>
                                            </ul>
                                        </div>
                                        <h2 id="IntegrationTopology" data-magellan-target="IntegrationTopology">Integration Topology</h2>
                                        <p>This diagram shows the topology used in the integration of Ubuntu Rsyslog logging with your WatchGuard Firebox.</p>
                                        <p class="img">
                                            <img src="_images/ubuntu_rsyslog/Integration Guide.png" style="visibility: visible;mso-wrap-style: square;width: 667px;height: 231px;" alt="Topology diagram of Firebox integration with an Ubuntu Server running Rsyslog" />
                                        </p>
                                        <h2 id="BeforeYouBegin" data-magellan-target="BeforeYouBegin">Before You Begin</h2>
                                        <p>Before you begin these procedures, make sure that:</p>
                                        <ul style="list-style-type: square;">
                                            <li>You have <a href="#Configur">configured a static IP address</a> for your Ubuntu server.</li>
                                            <li>You have the <a href="#Find">name of your Firebox</a>.</li>
                                        </ul>
                                        <h3 id="ConfigureStaticIPAddressforUbuntuServer" data-magellan-target="ConfigureStaticIPAddressforUbuntuServer"><a name="Configur"></a>Configure Static IP&#160;Address for Ubuntu Server</h3>
                                        <p>Before you configure Rsyslog logging on Ubuntu Server, you must configure a static IP address for the Ubuntu server.</p>
                                        <p>To configure a static IP address for the Ubuntu server:</p>
                                        <ol start="1">
                                            <li value="1">Download and install the <a href="https://www.ubuntu.com/server" target="_blank">Ubuntu Server</a> distribution. <br></br>For more information, go to the <a href="https://documentation.ubuntu.com/server/" target="_blank" style="font-style: italic;">Ubuntu Server documentation</a>. </li>
                                            <li value="2">Configure a static IP address&#160;for the Ubuntu server.<br />For details about how to configure a static IP address, go to <a href="https://documentation.ubuntu.com/server/explanation/networking/configuring-networks/" target="_blank">Configuring Networks</a> in the <i>Ubuntu Server documentation</i>.</li>
                                        </ol>
                                        <h3 id="FindtheFireboxName" data-magellan-target="FindtheFireboxName"><a name="Find"></a>Find the Firebox Name</h3>
                                        <p>You need the name of the Firebox when you configure Rsyslog logging on Ubuntu Server in the <a href="#Ubuntu">Configure Rsyslog Logging on Ubuntu Server</a> section.</p>
                                        <p>To find the name of the Firebox, from the Fireware UI:</p>
                                        <p class="BodyIndent">Select <b>System &gt; Information</b>.<br /><span class="NumContinued">The name of the Firebox appears in the Name text box. Make sure this name is unique to this system and note it for later use.</span></p>
                                        <p class="img_indent_1">
                                            <img src="_images/ubuntu_rsyslog/Firebox-name.jpg" title="information" style="max-height: auto;max-width: 100%;" alt="The screenshot of Firebox name" />
                                        </p>
                                        <h2 id="ConfiguretheFirebox" data-magellan-target="ConfiguretheFirebox">Configure the Firebox</h2>
                                        <p>The Syslog logging output from the WatchGuard Firebox is unencrypted. We recommend that you do not send unencrypted log messages on public networks.</p>
                                        <p>This example uses the internal default trusted IP address of <span class="Input">10.0.1.1</span> and the Rsyslog server at <span class="Input">10.0.1.2</span>. The configuration steps in this section use Fireware Web UI. </p>
                                        <p>To configure your Firebox:</p>
                                        <ol start="1">
                                            <li value="1">Log in to Fireware Web UI at <span class="Input">https://&lt;your firebox IP address&gt;:8080</span>.</li>
                                            <li value="2">Select <b>System &gt; Logging</b>.<br /><span class="NumContinued">The Logging page opens.</span></li>
                                            <li value="3">Select the <b>Syslog Server</b> tab.</li>
                                            <li value="4">Select the <b>Send Log Messages to These Syslog Servers</b> check box. </li>
                                            <li value="5">Click <b>Add</b>.<br /><span class="NumContinued">The Syslog Server dialog box opens.</span></li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/ubuntu_rsyslog/configure syslog server.png" title="" style="max-width: 100%;max-height: auto;" alt="Screenshot of the Syslog Server dialog box" />
                                        </p>
                                        <ol start="6">
                                            <li value="6">In the <b>IP Address</b> text box, type the IP address of your Rsyslog server. It is the static IP address that you configure in the <a href="#Configur" alt="Configure Static IP Address for Ubuntu Server" class="MCXref xref">Configure Static IP&#160;Address for Ubuntu Server</a>&#160;section.</li>
                                            <li value="7">Keep the default values for the <b>Port</b> and <b>Log Format</b> settings.<p class="Note">You must keep UDP port 514 open to send syslog output through your internal networks.</p></li>
                                            <li value="8">To include the date and time in the log message details when an event occurs on the Firebox, select the <b>The Time Stamp</b> check box.</li>
                                            <li value="9">To include the serial number of the Firebox in the log message details, select the <b>The Serial Number of the Device</b> check box.</li>
                                            <li value="10">Keep the default values for all other settings.</li>
                                            <li value="11">Click <b>OK</b>.</li>
                                            <li value="12">Click <b>Save</b>.</li>
                                        </ol>
                                        <h2 id="ConfigureRsyslogLoggingonUbuntuServer" data-magellan-target="ConfigureRsyslogLoggingonUbuntuServer"><a name="Ubuntu"></a>Configure Rsyslog Logging on Ubuntu Server</h2>
                                        <p>You can use the Rsyslog service on Ubuntu Server to redirect firewall logs to a single location where you can view and manage them.</p>
                                        <p>To configure Rsyslog logging on Ubuntu Server, after you <a href="#Configur" alt="Configure Static IP Address for Ubuntu Server" class="MCXref xref">Configure Static IP&#160;Address for Ubuntu Server</a>:</p>
                                        <ol start="1">
                                            <li value="1">To verify that Rsyslog is installed, run the <span class="Input">rsyslogd -v</span> command:&#160;<br />This is an example of the results:
				<br /><p class="OptionDef"><span class="Input">rsyslogd -v
				<br />rsyslogd 8.2312.0 (aka 2023.12) compiled with: </span></p><br /><p class="OptionDef_indent"><span class="Input">PLATFORM: x86_64-pc-linux-gnu
						<br />PLATFORM:&#160; (lsb_release -d):
						<br />FEATURE_REGEXP:Yes
						<br />GSSAPI Kerberos 5 support: Yes 
						<br />FEATURE_DEBUG (debug build, slow code): No
						<br />32bit Atomic operations supported: Yes
						<br />64bit Atomic operations supported: Yes 
						<br />memory allocator: system default
						<br />Runtime Instrumentation (slow code):
					No<br />uuid support: Yes	
				<br />systemd support: Yes<br />Config file: /etc/rsyslog.conf<br />PID file: /run/rsyslogd.pid<br />Number of Bits in RainerScript integers: 64</span></p><p class="OptionDef">If Rsyslog is not installed, use this command to install it manually:
			<br /><span class="Input">sudo aptitude install rsyslog</span></p></li>
                                        </ol>
                                        <ol start="4" data-mc-continue="true">
                                            <li value="2">To create a backup of the original <span class="Input">rsyslog.conf</span> file, run this command:<br /><span class="Input">sudo cp /etc/rsyslog.conf /etc/rsyslog.conf.orig</span></li>
                                            <li value="3"> Make the following changes to the <span class="Input">/etc/rsyslog.conf</span> file with the VI Editor or your Linux editor.<br /><span class="NumContinued">The module loads the receiver for UDP input. The input tells the server to accept connections on port 514.</span><![CDATA[
			]]><br /></li>
                                            <table style="mc-table-style: url('../../Resources/TableStyles/headertop.css');" class="TableStyle-headertop" cellspacing="0">
                                                <col class="TableStyle-headertop-Column-Column1" style="width: 327px;" />
                                                <col class="TableStyle-headertop-Column-Column1" style="width: 307px;" />
                                                <thead>
                                                    <tr class="TableStyle-headertop-Head-Header1">
                                                        <th class="TableStyle-headertop-HeadE-Column1-Header1">
                                                            <p>Change  From</p>
                                                        </th>
                                                        <th class="TableStyle-headertop-HeadD-Column1-Header1">
                                                            <p>Change To</p>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="TableStyle-headertop-Body-Body1">
                                                        <td class="TableStyle-headertop-BodyE-Column1-Body1">#provides UDP syslog reception</td>
                                                        <td class="TableStyle-headertop-BodyD-Column1-Body1">#provides UDP syslog reception</td>
                                                    </tr>
                                                    <tr class="TableStyle-headertop-Body-Body2">
                                                        <td class="TableStyle-headertop-BodyE-Column1-Body2">
                                                            <p>#module(load="imudp")
							</p>
                                                        </td>
                                                        <td class="TableStyle-headertop-BodyD-Column1-Body2">
                                                            <p>module(load="imudp")                            </p>
                                                        </td>
                                                    </tr>
                                                    <tr class="TableStyle-headertop-Body-Body1">
                                                        <td class="TableStyle-headertop-BodyB-Column1-Body1">
                                                            <p>#input(type="imudp" port="514")
							</p>
                                                        </td>
                                                        <td class="TableStyle-headertop-BodyA-Column1-Body1">
                                                            <p>input(type="imudp" port="514")
							</p>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </ol>
                                        <ol start="6">
                                            <li value="6">To create a folder to redirect your firewall logs to, run this command:<br /><span class="Input">sudo mkdir /var/log/firewall-logs</span></li>
                                            <li value="7">To allow the Rsyslog service to write to the <span class="Input">firewall-logs</span> folder, run this command:<br /><span class="Input">sudo chown syslog:syslog /var/log/firewall-logs</span></li>
                                            <li value="8">To redirect firewall log messages to the new folder, create a <span class="Input">10-custom.conf</span> file and include it in the <span class="Input">/etc/rsyslog.d</span> folder:<ol start="1"><li value="1">To include more configuration files in the <span class="Input">/etc/rsyslog.d</span> folder, run the <span class="Input">$IncludeConfig /etc/rsyslog.d/*.conf</span> command. <br /><span class="NumContinued">In the same folder, you might see other files, such as <span class="Input">20-ufw.conf</span>and <span class="Input">50-default.conf</span>, with different numeric prefixes. These numeric prefixes determine the order in which files are concatenated. Because the <span class="Input">10-custom.conf</span> file has a lower numeric prefix, it is executed before those other files.</span><br /></li><li value="2">To create the <span class="Input">10-custom.conf</span> file with the VI&#160;editor, run this command:<br /><span class="Input">sudo vi /etc/rsyslog.d/10-custom.conf</span></li><li value="3">To redirect the firewall log messages to the new folder and apply the appropriate label, add these lines to the file and save:<br /><span class="Input">if $hostname == '<span class="UserVariable">Firebox Name</span>' then {<br /> /var/log/firewall-logs/<span class="UserVariable">Firebox Name</span>.log <br />~<br />}</span><p class="Note">The <span class="Input">$hostname</span> value must match the Firebox name you found in the <a href="#Find" alt="Find the Firebox Name" class="MCXref xref">Find the Firebox Name</a> section.</p><p class="Note">The tilde (~) character notifies Rsyslog to drop the log message immediately, before other filters  catch those firewall logs. For more firewalls, add more if/then statements to the <span class="Input">10-custom.conf</span> file. </p></li></ol></li>
                                        </ol>
                                        <ol start="10">
                                            <li value="10">To modify the <span class="Input">Rsyslog</span> file under <span class="Input">/etc/logrotate.d</span> for automatic maintenance, run this command:<br /><span class="Input">sudo vi /etc/logrotate.d/rsyslog</span></li>
                                            <li value="11">To allow for log rotation, type this statement at the end:
				<br /><span class="Input">/var/log/firewall-logs
					<br />{ 
					<br /><p class="OptionDef_indent"><span class="Input">rotate 120
							<br />daily
							<br />missingok
							<br />notifempty
							<br />delaycompress
							<br />compress
							<br />postrotate
							<br />invoke-rc.d rsyslog rotate &gt; /dev/null
			<br />endscript</span></p><br />}</span><br /><br /><div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="#" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage" aria-expanded="false">Variable Descriptions:<img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="12" width="16" alt="Closed" data-mc-alt2="Open" /></a></span><div class="MCDropDownBody dropDownBody"><ul style="margin-left: 35pt;"><li><b>rotate</b> — Rotate log files  the specified number of times before they are removed or mailed to the address specified in a mail directive. If the count is 0, old versions are removed rather than rotated. In this example, log messages are rotated once a day for 120 times. </li><li><b>daily</b> — Log files are rotated every day.</li><li><b>missingok</b> — If there is no log file, go on to the next one and do not issue an error message.</li><li><b>notifempty</b> — Do not rotate the log file if it is empty.</li><li><b>delaycompress</b> — Postpone compression of the previous log file to the next rotation cycle. This takes effect only when used in combination with compression. It can be used when some programs cannot be told to close their log file and could therefore continue to write to the previous log file for some time.</li><li><b>compress</b> — Old versions of log files are compressed with gzip(1) by default.</li><li><b>postrotate / endscript</b> — The lines between postrotate and endscript (both of which must appear on lines by themselves) are executed (with /bin/sh) after the log file is rotated. In this example, log files are redirected to the empty folder of <span class="Input">/dev/null</span> after 120 days and deleted. To keep these files, redirect them to a folder for long-term storage.</li></ul></div></div></li>
                                        </ol>
                                        <ol start="12">
                                            <li value="12">To restart the Rsyslog service and implement all the changes, run this command:<br /><span class="Input">sudo service rsyslog restart</span></li>
                                        </ol>
                                        <h2 id="TesttheIntegration" data-magellan-target="TesttheIntegration">Test the Integration</h2>
                                        <p>This section describes how to test and troubleshoot the integration.</p>
                                        <h3 id="TroubleshootRsyslogSetup" data-magellan-target="TroubleshootRsyslogSetup">Troubleshoot Rsyslog Setup</h3>
                                        <p>To verify that the Rsyslog service runs, run this command:</p>
                                        <p class="BodyIndent"><span class="Input">$ service rsyslog status
				<br />rsyslog.service - System Logging Service
				<br />Loaded: &#160;&#160;&#160;loaded (/lib/systemd/system/rsyslog.service; enabled; vendor preset:  enabled)
				<br />Active: &#160;&#160;&#160;active (running) since Mon 2022-07-11 06:20:13 UTC; 8min ago
				<br />TriggeredBy: &#160;&#160;&#160;syslog.socket
				<br />Docs: &#160;&#160;&#160;&#160;&#160;man:rsyslogd(8)
				<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;http://www.rsyslog.com/doc/
				<br />Main PID:&#160;&#160;759 (rsyslogd)<br />Tasks: &#160;&#160;&#160;&#160;5
				(limit: 4612)<br />Memory: &#160;&#160;&#160;3.5M
				<br />CPU: &#160;&#160;&#160;&#160;&#160;&#160;16ms
				<br />CGroup: &#160;&#160;&#160;/system.slice/rsyslog.service
				<br /> └─759 /usr/sbin/rsyslogd -n
				-iNONE<br /><![CDATA[
			]]></span>
                                        </p>
                                        <p>To verify that UDP port 514 is open, run this command:</p>
                                        <p class="BodyIndent"><span class="Input">netstat -na | grep :514
				<br />udp&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0&#160;&#160;&#160;&#160;&#160; 0 0.0.0.0:514&#160; &#160;&#160;&#160; 0.0.0.0:*
			<br />udp6&#160;&#160;&#160;&#160;&#160;&#160; 0&#160;&#160;&#160;&#160;&#160; 0 :::514&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160; :::*</span>
                                        </p>
                                        <p>To verify that UDP traffic on port 514 is present on the receiving interface, run this command: </p>
                                        <p class="BodyIndent"><span class="Input">sudo tcpdump -c10 port 514<br />tcpdump: verbose output suppressed, use -v or -vv for full protocol decode<br />listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes<br />12:31:05.193268 IP 10.55.55.1.37506 &gt; 10.55.55.3.syslog: SYSLOG local3.info, length: 125</span>
                                        </p>
                                        <h2 id="SearchRsyslogOutput" data-magellan-target="SearchRsyslogOutput">Search Rsyslog Output</h2>
                                        <p>Use the <span class="Input">less</span> pager program to scroll through the log messages. The <span class="Input">less</span> pager can scroll forward and backward and provides basic search options.</p>
                                        <p>Use this command to open your log file in <span class="Input">less</span>:<br /><span class="Input">less /var/log/firewall-logs/<span class="UserVariable">Firebox Name</span>.log</span></p>
                                        <p>Then use the following keys to search.</p>
                                        <p><b>Forward search:</b>
                                        </p>
                                        <ul>
                                            <li><b>/</b> — Search for a pattern going forward to the next occurrence</li>
                                            <li><b>n</b> — Next match forward</li>
                                            <li><b>N</b> — Next match in backward direction</li>
                                        </ul>
                                        <p><b>Backward search:</b>
                                        </p>
                                        <ul>
                                            <li><b>?</b> — Search for a pattern going backward to the next occurrence</li>
                                            <li><b>n</b> — Next match backward</li>
                                            <li><b>N</b> — Next match in forward direction</li>
                                        </ul>
                                        <p><b>Beginning, end, and exit:</b>
                                        </p>
                                        <ul>
                                            <li><b>g</b> — Go to start of file</li>
                                            <li><b>G</b> — Go to end of file</li>
                                            <li><b>q</b> — Exit the <span class="Input">less</span> pager</li>
                                            <li><b>ZZ</b> — Exit the <span class="Input">less</span> pager</li>
                                        </ul>
                                        <p>You can also use the Linux <span class="Input">grep</span> command to search for character strings, as in the following examples.</p>
                                        <ul>
                                            <li>Search for a single user:<br /><span class="Input">grep 'Dave' /var/log/firewall-logs/WatchGuard-Firebox.log</span></li>
                                            <li>Search for multiple users:<br /><span class="Input">grep -E 'Dave|Mary|Joe' /var/log/firewall-logs/WatchGuard-Firebox.log</span></li>
                                            <li>Search for an IP address:<br /><span class="Input">grep '10.55.54.66' /var/log/firewall-logs/WatchGuard-Firebox.log</span></li>
                                            <li>Search for an IP address subnet:<br /><span class="Input">grep -E '10.0.?.?' /var/log/firewall-logs/WatchGuard-Firebox.log</span></li>
                                            <li>If the <span class="Input">grep</span> search output is too big, pipe the output to the less pager to scroll:<br /><span class="Input">grep -E '10.0.?.?' /var/log/firewall-logs/WatchGuard-Firebox.log | less</span></li>
                                            <li>To search through multiple firewall log files in the folder, use the recursive option:<br /><span class="Input">grep -r&#160; 'Unhandled' /var/log/firewall-logs/</span></li>
                                        </ul>
                                    </div>
                                    <p class="FooterTop"><a href="../../en-US/Fireware/support/doc_feedback.html">Give Us Feedback</a>&#160;&#160;●&#160;&#160;
            <a href="../../en-US/Fireware/support/getsupport.html">Get Support</a>&#160;&#160;●&#160;&#160;
            <a href="https://www.watchguard.com/wgrd-help/documentation/overview" target="_blank">All Product Documentation</a>&#160;&#160;●&#160;&#160;
            <a href="https://techsearch.watchguard.com/" target="_blank">Technical Search</a></p>
                                    <p class="Footer">© <span class="mc-variable Global.CurrentYear variable">2024</span> WatchGuard Technologies, Inc. All rights reserved. WatchGuard and the WatchGuard logo are registered trademarks or trademarks of WatchGuard Technologies in the United States and other countries. Various other trademarks are held by their respective owners.</p>
                                    <p class="Footer">&#160;</p>
                                    <div id="expand-collapse" title="Expand/collapse navigation" class="collapse">
                                    </div>
                                    <script src="../../Resources/MasterPages/scripts/expand-collapse.js">
                                    </script>
                                    <script src="../../Resources/MasterPages/scripts/cover-hide.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>