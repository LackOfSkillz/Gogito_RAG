<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Help_Center_Side_Nav" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-toc-path="Self-Help Tools|Integration Guides|Fireware" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Expires" content="3600" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="120x120" href="../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" /><title>Microsoft 365 with Firebox SMTP-Proxy Integration Guide</title>
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/help_(en-US).css" rel="stylesheet" type="text/css" />
        <link rel="apple-touch-icon" sizes="120x120" href="../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-T3SCZC3');/* ]]> */</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-left" role="navigation" id="offCanvas" data-off-canvas="" data-position="left" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 979px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../en-US/_intro/home.html" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div id="cover">
                                    </div>
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T3SCZC3" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="6" data-mc-toc="True"><span class="MCBreadcrumbsPrefix"> </span>
                                        </div>
                                    </div>
                                    <div role="main" id="mc-main-content">
                                        <h1 id="Microsoft365withFireboxSMTPProxyIntegrationGuide" data-magellan-target="Microsoft365withFireboxSMTPProxyIntegrationGuide"><a name="aanchor252"></a>
                                            <MadCap:concept term="Self-Help Tools" />Microsoft 365 with Firebox SMTP-Proxy Integration Guide</h1>
                                        <p>WatchGuard provides integration instructions to help our customers configure WatchGuard products to work with products created by other organizations. If you need more information or technical support about how to configure a third-party product, refer to the documentation and support resources for that product.</p>
                                        <p>This integration guide describes how to configure the Firebox to filter emails before they reach the Microsoft 365 Mail Server. </p>
                                        <h2 id="Contents" data-magellan-target="Contents">Contents</h2>
                                        <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 980px)" class="nocontent menu _Skins_Help_Center_Menu_Slide mc-component">
                                            <li class="tree-node"><a href="#Microsoft365withFireboxSMTPProxyIntegrationGuide">Microsoft 365 with Firebox SMTP-Proxy Integration Guide</a>
                                            </li>
                                            <li>
                                                <ul>
                                                    <li class="tree-node"><a href="#Contents">Contents</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#PlatformandSoftware">Platform and Software</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#IntegrationTopology">Integration Topology</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#BeforeYouBegin">Before You Begin</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#ConfigureYourFireboxforMicrosoft365">Configure  Your Firebox for Microsoft 365</a>
                                                    </li>
                                                    <li>
                                                        <ul>
                                                            <li class="tree-node"><a href="#AddaStaticNAT">Add a Static NAT</a>
                                                            </li>
                                                            <li class="tree-node"><a href="#AddanSMTPProxyAction">Add an SMTP Proxy Action</a>
                                                            </li>
                                                            <li class="tree-node"><a href="#AddanSMTPProxyPolicy">Add an SMTP-Proxy Policy</a>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li class="tree-node"><a href="#UpdatetheDomainMXRecord">Update the Domain MX Record </a>
                                                    </li>
                                                    <li class="tree-node"><a href="#TesttheIntegration">Test the Integration</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <div class="summary-left">
                                            <h2 id="PlatformandSoftware" data-magellan-target="PlatformandSoftware">Platform and Software</h2>
                                            <p>The platform and software used in this guide include:</p>
                                            <ul style="list-style-type: square;">
                                                <li>WatchGuard Firebox with Fireware v12.10 or higher</li>
                                                <li>Microsoft 365 subscription</li>
                                                <li>DNS Hosting provider</li>
                                            </ul>
                                        </div>
                                        <h2 id="IntegrationTopology" data-magellan-target="IntegrationTopology">Integration Topology</h2>
                                        <p class="img_indent_1">
                                            <img src="_images/Office365_Firebox_SMTP/SMTP-Proxy-Microsoft_365-Topology.png" title="" class="hasBorder" style="max-width: 100%;max-height: auto;" alt="Screenshot of the SMTP-Proxy Policy" />
                                        </p>
                                        <h2 id="BeforeYouBegin" data-magellan-target="BeforeYouBegin">Before You Begin</h2>
                                        <p>Before you begin these procedures, make sure that:</p>
                                        <ul>
                                            <li>Microsoft 365 Mail Server MX records are added in the DNS hosting provider.</li>
                                            <li>Microsoft 365 has added the domain (<i>ecosys.solutions</i>).</li>
                                            <li>Microsoft 365 Mail Server can send and receive mail using the domain (<i>ecosys.solutions</i>).</li>
                                        </ul>
                                        <h2 id="ConfigureYourFireboxforMicrosoft365" data-magellan-target="ConfigureYourFireboxforMicrosoft365">Configure  Your Firebox for Microsoft 365</h2>
                                        <p>On the Firebox, add an SMTP-proxy policy with a static NAT action, and enable content inspection in the proxy action. </p>
                                        <h3 id="AddaStaticNAT" data-magellan-target="AddaStaticNAT">Add a Static NAT</h3>
                                        <p>To add a static NAT, from Fireware Web UI:</p>
                                        <ol>
                                            <li value="1">Log in with an administrative account.</li>
                                            <li value="2">Select <b>Firewall &gt; SNAT</b>.</li>
                                            <li value="3">To add a new SNAT, click <b>Add</b>.<br /><span class="NumContinued">The Add SNAT&#160;page opens.</span></li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Office365_Firebox_SMTP/Firebox-Add-SNAT-001.png" title="" class="hasBorder" style="max-width: 100%;" alt="Screenshot of the Add a Static NAT page" />
                                        </p>
                                        <ol start="4" data-mc-continue="true">
                                            <li value="4">In the <b>Name</b> text box, enter a name for the SNAT.</li>
                                            <li value="5">Select <b>Static NAT</b>.</li>
                                            <li value="6">Click <b>Add</b>.<br /><span class="NumContinued">The Add Member dialog box opens.</span></li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Office365_Firebox_SMTP/Firebox-Add-SNAT-Member.png" title="" class="hasBorder" alt="The screenshot of Add SNAT member" style="max-width: 100%;" />
                                        </p>
                                        <ol start="7" data-mc-continue="true">
                                            <li value="7">From the <b>IP Address or Interface</b> drop-down list, select <b>External</b> or select an external IP address.</li>
                                            <li value="8">From the <b>Choose Type</b> drop-down list, select <b>FQDN</b>.<br /></li>
                                            <li value="9">In the <b>Host</b> text box, type or paste your Microsoft 365 domain MX&#160;record in the format: <span class="Input">&lt;Your Domain&gt;.mail.protection.outlook.com</span>.</li>
                                            <li value="10">Select the <b>Set Source IP</b> check box and enter your external IP address. </li>
                                            <li value="11">Click <b>OK</b>.</li>
                                        </ol>
                                        <h3 id="AddanSMTPProxyAction" data-magellan-target="AddanSMTPProxyAction">Add an SMTP Proxy Action</h3>
                                        <p>Because you cannot edit predefined proxy actions, you must clone a proxy action to customize the configuration.</p>
                                        <p>To add an SMTP&#160;proxy action, from Fireware Web UI:</p>
                                        <ol>
                                            <li value="1">Log in with an administrative account.</li>
                                            <li value="2">Select <b>Firewall &gt; Proxy Actions</b>.<br /><span class="NumContinued">The Proxy Actions page opens.</span></li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Office365_Firebox_SMTP/clone an incoming proxy action.png" title="" class="hasBorder" alt="The screenshot of choosing a proxy action" style="max-width: 100%;" />
                                        </p>
                                        <ol start="3" data-mc-continue="true">
                                            <li value="3">Click <b>SMTP-Incoming.Standard (Predefined)</b>. </li>
                                            <li value="4">Click <b>Clone</b>.</li>
                                            <li value="5">In the <b>Name</b> text box, enter a name for the proxy action. </li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Office365_Firebox_SMTP/click starttls envryption.png" title="" class="hasBorder" alt="The screenshot of clicking static encryption" style="max-width: 100%;" />
                                        </p>
                                        <ol start="5" data-mc-continue="true">
                                            <li value="6">Select <b>ESMTP &gt; STARTTLS Encryption</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Office365_Firebox_SMTP/enable starttls inspection.png" title="" class="hasBorder" alt="The screenshot of static encryption" style="max-width: 100%;" />
                                        </p>
                                        <ol start="6" data-mc-continue="true">
                                            <li value="7">Select the <b>Enable STARTTLS with Content Inspection</b> check box.</li>
                                            <li value="8">Select <b>ESMTP &gt; Authentication</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Office365_Firebox_SMTP/SMTP Proxy Action Settings.jpg" title="" class="hasBorder" alt="The screenshot of esmtp content inspection" style="max-width: 100%;" />
                                        </p>
                                        <ol start="8" data-mc-continue="true">
                                            <li value="9">From the <b>Action to take if no rule above is matched</b> drop-down list, select <b>Allow</b>.</li>
                                            <li value="10">Click <b>Save</b>.</li>
                                        </ol>
                                        <h3 id="AddanSMTPProxyPolicy" data-magellan-target="AddanSMTPProxyPolicy">Add an SMTP-Proxy Policy</h3>
                                        <p>To add an SMTP-Proxy policy, from Fireware Web UI:</p>
                                        <ol>
                                            <li value="1">Select <b>Firewall &gt; Firewall Policies &gt; Add Policy</b>.</li>
                                            <li value="2">Select <b>Proxies</b>, then select <b>SMTP-proxy</b> from the first adjacent drop-down list.</li>
                                            <li value="3">From the second adjacent drop-down list, select the SMTP proxy action you added. In this example, select <b>SMTP-Incoming.Standard.clone</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Office365_Firebox_SMTP/Firebox-Select-SMTP-proxy-type.png" title="" class="hasBorder" alt="The screenshot of adding proxy policy type" style="max-width: 100%;" />
                                        </p>
                                        <ol start="5">
                                            <li value="5">Click <b>Add Policy</b>.<br /><span class="NumContinued">The Firewall Policies / Add page opens.</span></li>
                                            <li value="6">Remove all members from the <b>From</b> and <b>To</b> Lists.</li>
                                            <li value="7">In the <b>From</b> list, click <b>Add</b>, then add a source with the alias <b>Any-External</b>.</li>
                                            <li value="8">In the <b>To</b> list, click <b>Add</b>, then add a destination with a <b>Member type</b> of <b>Static NAT</b>, and select the SNAT you added for this integration.</li>
                                            <li value="9">Leave the default value for all other settings.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/Office365_Firebox_SMTP/Firebox-SMTP-Proxy-Details.png" title="" class="hasBorder" alt="The screenshot of  SMTP Proxy Policy" />
                                        </p>
                                        <ol start="10" data-mc-continue="true">
                                            <li value="10">Click <b>Save</b>.</li>
                                        </ol>
                                        <h2 id="UpdatetheDomainMXRecord" data-magellan-target="UpdatetheDomainMXRecord">Update the Domain MX Record </h2>
                                        <p>After you save the SMTP proxy with the SNAT to Microsoft 365,  you must update your email domain MX record   to point to a host name that resolves to the Firebox external IP address. </p>
                                        <h2 id="TesttheIntegration" data-magellan-target="TesttheIntegration">Test the Integration</h2>
                                        <p>Verify that the Microsoft 365 Mail Server can receive the mail filtered by your Firebox with the domain (<i>ecosys.solutions</i>).</p>
                                    </div>
                                    <p class="FooterTop"><a href="../../en-US/Fireware/support/doc_feedback.html">Give Us Feedback</a>&#160;&#160;●&#160;&#160;
            <a href="../../en-US/Fireware/support/getsupport.html">Get Support</a>&#160;&#160;●&#160;&#160;
            <a href="https://www.watchguard.com/wgrd-help/documentation/overview" target="_blank">All Product Documentation</a>&#160;&#160;●&#160;&#160;
            <a href="https://techsearch.watchguard.com/" target="_blank">Technical Search</a></p>
                                    <p class="Footer">© <span class="mc-variable Global.CurrentYear variable">2024</span> WatchGuard Technologies, Inc. All rights reserved. WatchGuard and the WatchGuard logo are registered trademarks or trademarks of WatchGuard Technologies in the United States and other countries. Various other trademarks are held by their respective owners.</p>
                                    <p class="Footer">&#160;</p>
                                    <div id="expand-collapse" title="Expand/collapse navigation" class="collapse">
                                    </div>
                                    <script src="../../Resources/MasterPages/scripts/expand-collapse.js">
                                    </script>
                                    <script src="../../Resources/MasterPages/scripts/cover-hide.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>