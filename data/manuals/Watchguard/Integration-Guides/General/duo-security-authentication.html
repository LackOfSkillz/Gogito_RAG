<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Help_Center_Side_Nav" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-toc-path="Self-Help Tools|Integration Guides|Fireware" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Expires" content="3600" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="120x120" href="../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" /><title>Duo Security Authentication Integration Guide</title>
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/help_(en-US).css" rel="stylesheet" type="text/css" />
        <link href="../../Resources/TableStyles/headertop.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="apple-touch-icon" sizes="120x120" href="../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-T3SCZC3');/* ]]> */</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-left" role="navigation" id="offCanvas" data-off-canvas="" data-position="left" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 979px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../en-US/_intro/home.html" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div id="cover">
                                    </div>
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T3SCZC3" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="6" data-mc-toc="True"><span class="MCBreadcrumbsPrefix"> </span>
                                        </div>
                                    </div>
                                    <div role="main" id="mc-main-content">
                                        <h1 id="DuoSecurityAuthenticationIntegrationGuide" data-magellan-target="DuoSecurityAuthenticationIntegrationGuide"><a name="aanchor3315"></a>
                                            <MadCap:concept term="Self-Help Tools" />Duo Security Authentication Integration Guide</h1>
                                        <h2 id="DuoSecurityandFireboxIntegrationOverview" data-magellan-target="DuoSecurityandFireboxIntegrationOverview">Duo Security and Firebox Integration Overview</h2>
                                        <p>This document describes the steps to integrate WatchGuard Mobile VPN with SSL client software download access and Mobile VPN with SSL client authentication with Duo Security’s® two-factor authentication solution. This integration uses an existing NPS server installed on a domain controller that also contains the Duo Security Authentication Proxy.  For information about how to integrate Duo Security RADIUS Authentication without an NPS server, go to the <a href="duo-security-authentication-radius-active directory.html" alt="Duo Security RADIUS Authentication Integration Guide" class="MCXref xref">Duo Security RADIUS Authentication Integration Guide</a></p>
                                        <h2 id="Contents" data-magellan-target="Contents">Contents</h2>
                                        <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 980px)" class="nocontent menu _Skins_Help_Center_Menu_Slide mc-component">
                                            <li class="tree-node"><a href="#DuoSecurityAuthenticationIntegrationGuide">Duo Security Authentication Integration Guide</a>
                                            </li>
                                            <li>
                                                <ul>
                                                    <li class="tree-node"><a href="#DuoSecurityandFireboxIntegrationOverview">Duo Security and Firebox Integration Overview</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#Contents">Contents</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#TestTopology">Test Topology</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#PlatformandSoftware">Platform and Software</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#Configuration">Configuration</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#ConfigureMicrosoftNPSServer">Configure Microsoft NPS Server</a>
                                                    </li>
                                                    <li class="tree-node"><a href="#ConfigureFirebox">Configure Firebox</a>
                                                    </li>
                                                    <li>
                                                        <ul>
                                                            <li class="tree-node"><a href="#ConfigureRADIUSAuthentication">Configure RADIUS Authentication</a>
                                                            </li>
                                                            <li class="tree-node"><a href="#ConfigureMobileVPNwithSSL">Configure Mobile VPN with SSL</a>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li class="tree-node"><a href="#ConfigureDuo">Configure Duo</a>
                                                    </li>
                                                    <li>
                                                        <ul>
                                                            <li class="tree-node"><a href="#SetUpanApplication">Set Up an Application</a>
                                                            </li>
                                                            <li class="tree-node"><a href="#SyncUserstoDuofromActiveDirectory">Sync Users to Duo from Active Directory</a>
                                                            </li>
                                                            <li class="tree-node"><a href="#ConfiguretheDuoAuthenticationProxyforPrimaryAuthentication">Configure the Duo Authentication Proxy for Primary Authentication</a>
                                                            </li>
                                                            <li class="tree-node"><a href="#ConfiguretheDuoAuthenticationProxytoWorkwiththeFirebox">Configure the Duo Authentication Proxy to Work with the Firebox</a>
                                                            </li>
                                                            <li class="tree-node"><a href="#StarttheDuoAuthenticationProxy">Start the Duo Authentication Proxy</a>
                                                            </li>
                                                            <li class="tree-node"><a href="#BindtheUserwiththeDuoMobileApplication">Bind the User with the Duo Mobile Application</a>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li class="tree-node"><a href="#TesttheIntegration">Test the Integration</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <p>This is the workflow for two-factor authentication with Duo Security:</p>
                                        <p class="img">
                                            <img src="_images/duo-security-authentication/Integration Guide_4.png" style="max-width: 100%;max-height: auto;" alt="Diagram of Firebox and Duo two-factor authentication workflow diagram" />
                                        </p>
                                        <ol start="1">
                                            <li value="1">A user initiates primary authentication to the WatchGuard Firebox.</li>
                                            <li value="2">The Firebox sends an authentication request to the Duo Security Authentication Proxy.</li>
                                            <li value="3">The Authentication Proxy completes primary authentication using RADIUS.</li>
                                            <li value="4">The Authentication Proxy establishes a secure connection with the Duo Security service.</li>
                                            <li value="5">The Duo Security service completes  the secondary authentication.</li>
                                            <li value="6">The Authentication Proxy receives a secondary authentication result from the Duo Security service.</li>
                                            <li value="7">The Firebox grants the user access.</li>
                                        </ol>
                                        <h2 id="TestTopology" data-magellan-target="TestTopology">Test Topology</h2>
                                        <p>This diagram shows the test topology for this integration:</p>
                                        <p class="img">
                                            <img src="_images/duo-security-authentication/topy.jpg" alt="Topology diagram for Firebox and Duo integration" style="max-width: 100%;max-height: auto;" />
                                        </p>
                                        <h2 id="PlatformandSoftware" data-magellan-target="PlatformandSoftware">Platform and Software</h2>
                                        <p>The hardware and software used in this integration include:</p>
                                        <ul>
                                            <li style="list-style-type: disc;">Firebox with Fireware v12.10 or higher</li>
                                            <li style="list-style-type: disc;">Duo Security Authentication Proxy 6.1.0 on Windows </li>
                                            <li style="list-style-type: disc;">Windows Server 2019 with Microsoft Network Policy Server (NPS) and Active Directory Domain Services</li>
                                            <li style="list-style-type: disc;">Duo Mobile Application 4.53.0.588.1 on iOS</li>
                                        </ul>
                                        <h2 id="Configuration" data-magellan-target="Configuration">Configuration</h2>
                                        <p>To complete this integration, you must have:</p>
                                        <ul>
                                            <li style="list-style-type: disc;">Duo account</li>
                                            <li style="list-style-type: disc;">Duo Security Authentication Proxy</li>
                                            <li style="list-style-type: disc;">RADIUS server (NPS)</li>
                                            <li style="list-style-type: disc;">Active Directory Domain Services with user and group configured</li>
                                            <li style="list-style-type: disc;">WatchGuard Firebox</li>
                                        </ul>
                                        <p>Use the Duo account to log in to the Duo Service. The Duo Security Authentication Proxy acts as a bridge. It communicates with the RADIUS server, the Duo Security service in the cloud, the WatchGuard Firebox, and the Duo mobile app. The integration uses the RADIUS server  for primary user authentication.</p>
                                        <p>In our configuration, the Duo Security Authentication Proxy and the RADIUS server (Microsoft NPS) are located on the same subnet.</p>
                                        <h2 id="ConfigureMicrosoftNPSServer" data-magellan-target="ConfigureMicrosoftNPSServer"><a name="ConfigureNPS"></a>Configure Microsoft NPS Server</h2>
                                        <p class="Note">For instructions on how to configure Active Directory Domain Services, go to the Microsoft documentation for Active Directory.</p>
                                        <ol start="1">
                                            <li value="1">On the Windows server, run Server Manager.</li>
                                            <li value="2">Select <b>Tools &gt; Network Policy Server</b>.<br /><span class="NumContinued">The Network Policy Server console opens.</span></li>
                                            <li value="3">Select <b>RADIUS Clients and Servers &gt; RADIUS Clients</b>.</li>
                                            <li value="4">Right-click <b>RADIUS Clients</b>, then select <b>New</b>.<br /><span class="NumContinued">The Duo Proxy Properties dialog box opens.</span></li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/Configure Microsoft NPS Server.jpg" alt="Screenshot of the NPS RADIUS client configuration" style="max-width: 100%;max-height: auto;" />
                                            </p>
                                            <li value="5">In the <b>Friendly Name</b> text box, type a name.</li>
                                            <li value="6">In the <b>Address (IP or DNS)</b> text box, type the IP address of the Duo Authentication Proxy. In our example, we use <span class="Input">10.0.1.133</span>.</li>
                                            <li value="7">In the <b>Shared Secret</b> and <b>Confirm Shared Secret</b> text boxes, type a shared secret key. This key is used to communicate with the Duo Authentication Proxy.<p class="Note">You must use the same shared secret key when you configure Duo Authentication Proxy for Primary Authentication.</p></li>
                                            <li value="8">Click <b>OK</b>.<br /><span class="NumContinued">The RADIUS Clients section shows the added details.</span></li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/Configure Microsoft NPS Server 2.jpg" alt="Screenshot of the NPS RADIUS client configuration" style="max-width: 100%;max-height: auto;" />
                                            </p>
                                            <li value="9">Select <b>Polices &gt; Connection Request Policies</b>. Make sure the default policy is enabled.</li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/Configure Microsoft NPS Server 3.jpg" alt="Screenshot of the NPS policy configuration" style="max-height: auto;max-width: 100%;" />
                                            </p>
                                            <li value="10">Right-click <b>Network Policies</b>, then select <b>New</b>.<br /><span class="NumContinued">The New Network Policy page  opens.</span></li>
                                            <li value="11">In the <b>Policy Name</b> text box, type a name for this policy. In our example, we use <span class="Input">ecotest</span>.</li>
                                            <li value="12">Click <b>Next</b>.</li>
                                            <li value="13">From the <b>Specify Conditions</b> section, click <b>Add</b>.</li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/Configure Microsoft NPS Server 4.jpg" alt="Screenshot of the NPS policy conditions configuration" style="max-width: 100%;max-height: auto;" />
                                            </p>
                                            <li value="14">Select <b>User Groups</b>, then click <b>Add</b>.</li>
                                            <li value="15">Click <b>Add Groups</b>.</li>
                                            <li value="16">In the <b>Enter the Object Name to Select</b> text box, type the group name. The name of this group must be the same as the name of the Active Directory group your users belong to.</li>
                                            <li value="17">Click <b>OK</b>.</li>
                                            <li value="18">Click <b>OK</b>.</li>
                                            <li value="19">Click <b>Next</b>.</li>
                                            <li value="20">Click <b>Next</b>.</li>
                                            <li value="21">From the <b>Configure Authentication Methods</b> section, select the <b>Unencrypted Authentication (PAP, SPAP)</b> check box.</li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/Configure Microsoft NPS Server 5.jpg" alt="Screenshot of the NPS policy authentication methods configuration" style="max-width: 100%;max-height: auto;" />
                                            </p>
                                            <li value="22">Click <b>Next</b>.</li>
                                            <li value="23">Click <b>No</b>.</li>
                                            <li value="24">Click <b>Next</b>.</li>
                                            <li value="25">In the <b>Configure Settings</b> section, click <b>Add</b>. In our example, we use group authentication. If you want to use user authentication, skip Steps 25—31.</li>
                                            <li value="26">From the <b>Attributes</b> list, select <b>Filter-Id</b>, then click <b>Add</b>.</li>
                                            <li value="27">Click <b>Add</b>.</li>
                                            <li value="28">On the <b>Attribute Information</b> page, in the text box, type a group name. The name of this group must be the same as the name of the Active Directory group your users belong to.</li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/Configure Microsoft NPS Server 6.jpg" alt="Screenshot of the NPS attribute information configuration" style="max-height: auto;max-width: 100%;" />
                                            </p>
                                            <li value="29">Click <b>OK</b>.</li>
                                            <li value="30">Click <b>OK</b>.</li>
                                            <li value="31">Click <b>Close</b>.</li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/Configure Microsoft NPS Server 7.jpg" alt="Screenshot of the NPS configuration settings" style="max-height: auto;max-width: 100%;" />
                                            </p>
                                            <li value="32">Click <b>Next</b>.</li>
                                            <li value="33">Click <b>Finish</b>.</li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/Configure Microsoft NPS Server 8.jpg" alt="Screenshot of the NPS policy completed configuration" style="max-width: 100%;max-height: auto;" />
                                            </p>
                                            <li value="34">Right-click <b>NPS (Local)</b>, then select <b>Register Server in Active Directory</b>.</li>
                                            <li value="35">Click <b>OK</b>.</li>
                                            <li value="36">Click <b>OK</b>.</li>
                                        </ol>
                                        <h2 id="ConfigureFirebox" data-magellan-target="ConfigureFirebox">Configure Firebox</h2>
                                        <p>To configure the Firebox, you must:</p>
                                        <ol>
                                            <li value="1"><a href="#Configur" alt="Configure RADIUS Authentication" class="MCXref xref">Configure RADIUS Authentication</a>
                                            </li>
                                            <li value="2"><a href="#Configur3" alt="Configure Mobile VPN with SSL" class="MCXref xref">Configure Mobile VPN with SSL</a> </li>
                                        </ol>
                                        <h3 id="ConfigureRADIUSAuthentication" data-magellan-target="ConfigureRADIUSAuthentication"><a name="Configur"></a>Configure RADIUS Authentication</h3>
                                        <p>To configure RADIUS authentication, from Fireware Web UI:</p>
                                        <ol start="1">
                                            <li value="1">Log in to Fireware Web UI (<span class="Input">https://&lt;your firebox IP address&gt;:8080</span>).</li>
                                            <li value="2">Select <b>Authentication &gt; Servers</b>.<br /><span class="NumContinued">The Authentication Servers page opens.</span></li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/Firebox6.png" alt="Screenshot of the Firebox Authentication Servers page" style="max-width: 100%;max-height: auto;" />
                                            </p>
                                            <li value="3">From the <b>Authentication Servers</b> list, select <b>RADIUS</b>.<br /><span class="NumContinued">The RADIUS page opens.</span></li>
                                            <li value="4">Click <b>Add</b>.<br /><span class="NumContinued">The Add page opens.</span></li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/Firebox Configre.jpg" alt="Screenshot of the primary RADIUS server settings on the Firebox" style="max-height: auto;max-width: 100%;" />
                                            </p>
                                            <li value="5">In the <b>Domain Name</b> text box, type the domain name for this RADIUS server. Users must specify this domain name on the user login page. You cannot change the domain name after you save the settings.</li>
                                            <li value="6">From the <b>Primary Server Settings</b> section, select the <b>Enable RADIUS Server</b> check box.</li>
                                            <li value="7">In the <b>IP Address</b> text box, type the IP address of the Duo Authentication Proxy.</li>
                                            <li value="8">In the <b>Port</b> text box, keep the default <b>1812</b> text. </li>
                                            <li value="9">In the <b>Shared Secret</b> and <b>Confirm Secret</b> text boxes, type a shared secret key. This key is used to communicate with the Duo Authentication Proxy Server.</li>
                                            <li value="10">In the <b>Timeout</b> text box, type <span class="Input">60</span>.</li>
                                            <li value="11">In the <b>Group Attribute</b> text box, keep the default text.</li>
                                            <li value="12">Click <b>Save</b>.</li>
                                        </ol>
                                        <h3 id="ConfigureMobileVPNwithSSL" data-magellan-target="ConfigureMobileVPNwithSSL"><a name="Configur3"></a>Configure Mobile VPN with SSL</h3>
                                        <p>To configure mobile VPN&#160;with SSL, from Fireware Web UI:</p>
                                        <ol>
                                            <li value="1">Select <b>VPN &gt; Mobile VPN</b>.</li>
                                            <li value="2">From the SSL section, click <b>Manually Configure</b>.</li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/Firebox diagram3.png" alt="Screenshot of the Mobile VPN with SSL page on the Firebox" style="max-width: 100%;max-height: auto;" />
                                            </p>
                                            <li value="3">Select the <b>Activate Mobile VPN with SSL</b> check box.</li>
                                            <li value="4">From the <b>General</b> section, in the <b>Primary</b> text box, type the public IP address (External IP address) or domain name of the Firebox. This is the IP address or domain name that Mobile VPN with SSL clients connect to by default.</li>
                                            <li value="5">Select the <b>Authentication</b> tab.</li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/Firebox Configre 2.jpg" alt="Screenshot of Authentication Servers configuration page on the Firebox" style="max-height: auto;max-width: 100%;" />
                                            </p>
                                            <li value="6">From the <b>Authentication Server</b> drop-down list, select the authentication server you created.</li>
                                            <li value="7">Click <b>Add</b>.</li>
                                            <li value="8">From the <b>Authentication Server</b> list, select your authentication server, then click <b>Move Up</b> to move it to the top of the list to make it the default authentication server.<br /><span class="NumContinued">Mobile VPN with SSL uses the default authentication server unless a user specifies an authentication server in the User Name text box on the Mobile VPN with SSL client.</span></li>
                                            <li value="9">From the <b>Users and Groups</b> section, from the <b>Create New</b> drop-down list, select the authentication server you created. </li>
                                            <li value="10">From the adjacent drop-down list, select <b>Group</b>. You can add a user or a group. In our example, we add a group.</li>
                                            <li value="11">Click <b>Add</b>.<br /><span class="NumContinued">The Add User or Group dialog box opens.</span></li>
                                            <li value="12">For <b>Type</b>, select <b>Group</b>.</li>
                                            <li value="13">In the <b>Name</b> text box, type a name for the group. The name of this group must be the same as the name of the Active Directory group your users belong to.</li>
                                            <li value="14">From the <b>Authentication Server</b> drop-down list, select your authentication server.</li>
                                            <li value="15">Click <b>Save</b>.</li>
                                            <li value="16">Click <b>Save</b>.</li>
                                        </ol>
                                        <h2 id="ConfigureDuo" data-magellan-target="ConfigureDuo">Configure Duo</h2>
                                        <p>To configure Duo, complete these steps:</p>
                                        <ol>
                                            <li value="1"><a href="#_Create_a_Duo" alt="Set Up an Application" class="MCXref xref">Set Up an Application</a>
                                            </li>
                                            <li value="2"><a href="#Sync" class="MCXref xref">Sync Users to Duo from Active Directory</a>
                                            </li>
                                            <li value="3"><a href="#Configur4" class="MCXref xref">Configure the Duo Authentication Proxy for Primary Authentication</a>
                                            </li>
                                            <li value="4"><a href="#Configur2" class="MCXref xref">Configure the Duo Authentication Proxy to Work with the Firebox</a>
                                            </li>
                                            <li value="5"><a href="#Start" class="MCXref xref">Start the Duo Authentication Proxy</a>
                                            </li>
                                            <li value="6"><a href="#Binding" class="MCXref xref">Bind the User with the Duo Mobile Application</a>
                                            </li>
                                        </ol>
                                        <h3 id="SetUpanApplication" data-magellan-target="SetUpanApplication"><a name="_Create_a_Duo"></a>Set Up an Application</h3>
                                        <ol start="1">
                                            <li value="1">Sign up for a <a href="https://duo.com/" target="_blank">Duo account</a>.</li>
                                            <li value="2">Log in to the Duo Admin Panel, then select <b>Applications</b>.</li>
                                            <li value="3">Select <b>Protect an Application</b>.</li>
                                            <li value="4"> From the application list, select <b>RADIUS</b>.</li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/DUO Configre.jpg" alt="Screenshot of Authentication Servers configuration page on the Duo" style="max-height: auto;max-width: 100%;" />
                                            </p>
                                            <li value="5">To view the values for the <b>Integration Key</b>, <b>Secret Key</b>, and <b>API Hostname</b>, select <b>Protect</b>. Copy these values because you will use them in the <a href="#Configur2" class="MCXref xref">Configure the Duo Authentication Proxy to Work with the Firebox</a> section.</li>
                                            <li value="6">Click <b>Save</b>.</li>
                                        </ol>
                                        <h3 id="SyncUserstoDuofromActiveDirectory" data-magellan-target="SyncUserstoDuofromActiveDirectory"><a name="Sync"></a>Sync Users to Duo from Active Directory</h3>
                                        <p>Organizations with an existing on-premises Microsoft Active Directory domain can import users, phones, and groups into Duo with directory synchronization.</p>
                                        <p>For detailed instructions to sync users from Active Directory into Duo, go to <a href="https://duo.com/docs/adsync">Synchronizing Users from Active Directory</a> in the Duo documentation.</p>
                                        <h3 id="ConfiguretheDuoAuthenticationProxyforPrimaryAuthentication" data-magellan-target="ConfiguretheDuoAuthenticationProxyforPrimaryAuthentication"><a name="Configur4"></a>Configure the Duo Authentication Proxy for Primary Authentication</h3>
                                        <p>The Duo Authentication Proxy is the system that validates the user password. In most cases, you must configure the Proxy to communicate with a RADIUS server.</p>
                                        <p>To configure the Duo Authentication Proxy for Primary Authentication:</p>
                                        <ol>
                                            <li value="1">Open <b>Duo Authentication Proxy Manager</b>.</li>
                                            <li value="2">Configure the <span class="Input">authproxy.cfg</span> file. These are the sections of the file:<ol><li value="1"><span class="Input">[cloud]</span>: Already configured in the <a href="#Sync">Sync Users to Duo from Active Directory</a> section.</li><li value="2"><span class="Input">[radius_client]</span>: To configure the proxy, you must specify the values of these properties:</li></ol><table style="margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/headertop.css');" class="TableStyle-headertop" cellspacing="0"><col class="TableStyle-headertop-Column-Column1" style="width: 203px;" /><col class="TableStyle-headertop-Column-Column1" style="width: 320px;" /><thead><tr class="TableStyle-headertop-Head-Header1"><th class="TableStyle-headertop-HeadE-Column1-Header1"><p>Required Properties</p></th><th class="TableStyle-headertop-HeadD-Column1-Header1"><p>Description</p></th></tr></thead><tbody><tr class="TableStyle-headertop-Body-Body1"><td class="TableStyle-headertop-BodyE-Column1-Body1"><span class="Input">host</span></td><td class="TableStyle-headertop-BodyD-Column1-Body1"><p>The IP address of the RADIUS server</p></td></tr><tr class="TableStyle-headertop-Body-Body2"><td class="TableStyle-headertop-BodyB-Column1-Body2"><p><span class="Input">secret</span></p></td><td class="TableStyle-headertop-BodyA-Column1-Body2"><p>A shared secret between the Proxy and the RADIUS server</p></td></tr></tbody></table><p>For information about other optional properties, go to <a href="https://duo.com/docs/radius">Duo Two-Factor Authentication with RADIUS and Primary Authentication</a> in the Duo documentation.</p><p>For example:</p><p><span class="Input">[radius_client]</span><br /><span class="Input">host=10.0.1.132</span><br /><span class="Input">secret=password</span><br /><span class="Input">pass_through_all=true</span></p></li>
                                        </ol>
                                        <h3 id="ConfiguretheDuoAuthenticationProxytoWorkwiththeFirebox" data-magellan-target="ConfiguretheDuoAuthenticationProxytoWorkwiththeFirebox"><a name="Configur2"></a>Configure the Duo Authentication Proxy to Work with the Firebox</h3>
                                        <p>To configure the Duo Authentication Proxy to work with the Firebox, create a <span class="Input">[radius_server_auto]</span> section in the <span class="Input">authproxy.cfg</span> file.</p>
                                        <p>This table provides a list of the properties that you must configure in the <span class="Input">[radius_server_auto]</span> section of the <span class="Input">authproxy.cfg</span> file:</p>
                                        <table style="margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/headertop.css');" class="TableStyle-headertop" cellspacing="0">
                                            <col class="TableStyle-headertop-Column-Column1" style="width: 264px;" />
                                            <col class="TableStyle-headertop-Column-Column1" style="width: 659px;" />
                                            <thead>
                                                <tr class="TableStyle-headertop-Head-Header1">
                                                    <th class="TableStyle-headertop-HeadE-Column1-Header1">
                                                        <p>Properties</p>
                                                    </th>
                                                    <th class="TableStyle-headertop-HeadD-Column1-Header1">
                                                        <p>Description</p>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="TableStyle-headertop-Body-Body1">
                                                    <td class="TableStyle-headertop-BodyE-Column1-Body1"><span class="Input">ikey</span>
                                                    </td>
                                                    <td class="TableStyle-headertop-BodyD-Column1-Body1">
                                                        <p>The <b>Integration key</b>, as referenced in the <a href="#_Create_a_Duo">Set Up an Application</a> section of this document.</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-headertop-Body-Body2">
                                                    <td class="TableStyle-headertop-BodyE-Column1-Body2"><span class="Input">skey</span>
                                                    </td>
                                                    <td class="TableStyle-headertop-BodyD-Column1-Body2">
                                                        <p>The <b>Secret key</b>, as referenced in the <a href="#_Create_a_Duo">Set Up an Application</a> section of this document.</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-headertop-Body-Body1">
                                                    <td class="TableStyle-headertop-BodyE-Column1-Body1"><span class="Input">api_host</span>
                                                    </td>
                                                    <td class="TableStyle-headertop-BodyD-Column1-Body1">
                                                        <p>The <b>API hostname</b>, as referenced in the <a href="#_Create_a_Duo">Set Up an Application</a> section of this document.</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-headertop-Body-Body2">
                                                    <td class="TableStyle-headertop-BodyE-Column1-Body2"><span class="Input">radius_ip_1</span>
                                                    </td>
                                                    <td class="TableStyle-headertop-BodyD-Column1-Body2">
                                                        <p>The IP address of the Firebox that is connected to the Proxy.</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-headertop-Body-Body1">
                                                    <td class="TableStyle-headertop-BodyE-Column1-Body1"><span class="Input">radius_secret_1</span>
                                                    </td>
                                                    <td class="TableStyle-headertop-BodyD-Column1-Body1">
                                                        <p>A shared secret between the Proxy and the Firebox.</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-headertop-Body-Body2">
                                                    <td class="TableStyle-headertop-BodyB-Column1-Body2">
                                                        <p><span class="Input">client</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-headertop-BodyA-Column1-Body2">
                                                        <p>Set this value to <b>radius_client</b>, so that the Proxy uses RADIUS for primary authentication.</p>
                                                        <p>Make sure a <span class="Input">[radius_client]</span> section is configured, as described in the <a href="#Configur4" class="MCXref xref">Configure the Duo Authentication Proxy for Primary Authentication</a>&#160;section of this document.</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <p>For information about optional properties, go to <a href="https://duo.com/docs/radius">Duo Two-Factor Authentication with RADIUS and Primary Authentication</a> in the Duo documentation.</p>
                                        <p>For example:</p>
                                        <p><span class="Input">[radius_server_auto]</span>
                                            <br /><span class="Input">ikey=DIEXXXXXXXXXXXXXXXXF</span>
                                            <br /><span class="Input">skey=hrPXYMuKjfXXXXXXXXXXXXXXXXmw7zBz1nLV4wVC</span>
                                            <br /><span class="Input">api_host=api-XXXXXXXX.duosecurity.com</span>
                                            <br /><span class="Input">radius_ip_1=10.0.1.130</span>
                                            <br /><span class="Input">radius_secret_1=password</span>
                                            <br /><span class="Input">client=radius_client</span>
                                            <br /><span class="Input">port=1812</span>
                                            <br /><span class="Input">failmode=safe</span>
                                            <br /><span class="Input">pass_through_all=true</span>
                                        </p>
                                        <p>This is an example of a complete configuration file:</p>
                                        <p class="img_indent_1">
                                            <img src="_images/duo-security-authentication/DUO Configre 2.jpg" alt="Screenshot of Authentication Servers configuration page on the Duo" style="max-height: auto;max-width: 100%;" />
                                        </p>
                                        <p class="Note">After you modify the Proxy configuration file, the user  clicks the <b>Validate</b> button in <b>Duo Authentication Proxy Manager</b> to verify the configuration file is correct. If the user uses NPS as the RADIUS server, then the validation of the <i>[radius_client]</i> section  fails and this output message appears:<br /> <img src="_images/duo-security-authentication/DUO Configre 3.jpg" alt="Screenshot of Authentication Servers configuration page on the Duo" style="max-height: auto;max-width: 100%;" /><br />This is because NPS does not support the Status-Server message [Code 12 Status-Server (experimental) in RFC2865].<br />The Duo Security Authentication Proxy validate packet includes this Status-Server message.  The WatchGuard Firebox RADIUS request packet does not include this Status-Server message.<br />This failure does not affect any function and can be ignored.</p>
                                        <h3 id="StarttheDuoAuthenticationProxy" data-magellan-target="StarttheDuoAuthenticationProxy"><a name="Start"></a>Start the Duo Authentication Proxy</h3>
                                        <p>To start the Duo authentication proxy:</p>
                                        <ul>
                                            <li>In the <b>Duo Authentication Proxy Manager</b> UI, click <b>Start Service</b>.</li>
                                        </ul>
                                        <h3 id="BindtheUserwiththeDuoMobileApplication" data-magellan-target="BindtheUserwiththeDuoMobileApplication"><a name="Binding"></a>Bind the User with the Duo Mobile Application</h3>
                                        <p> After the process to sync users from Active Directory into Duo, bind the user with your mobile device.</p>
                                        <p>For detailed instructions about how to bind the user with your mobile device, go to <a href="https://duo.com/docs/administration-users#activating-duo-mobile">Activating Duo Mobile</a> in the Duo documentation.</p>
                                        <h2 id="TesttheIntegration" data-magellan-target="TesttheIntegration">Test the Integration</h2>
                                        <p style="page-break-after: avoid;page-break-before: avoid;">To test the integration of your Mobile VPN with SSL, authenticate with a mobile token on your mobile device. You can authenticate with a passcode or a push notification.</p>
                                        <p class="Note">If you select the passcode authentication, you must type the password followed by a comma and append the passcode from the Duo Mobile App.</p>
                                        <p style="page-break-after: avoid;page-break-before: avoid;">In this example, we show the push authentication method (users receive a push notification in the mobile app that they must approve to authenticate).</p>
                                        <ol>
                                            <li value="1">Open your Mobile VPN with SSL client.</li>
                                            <li value="2">In the <b>Server</b> text box, type the external IP address of the Firebox.</li>
                                            <li value="3">Type your user name and password.</li>
                                            <li value="4">Click <b>Connect</b>.</li>
                                            <li value="5">Approve the authentication request on your mobile device.<br /><span class="NumContinued">You are logged in successfully.</span></li>
                                            <p class="img">
                                                <img src="_images/duo-security-authentication/Test.jpg" alt="Screenshot of the Mobile VPN with SSL connection details" style="max-height: auto;max-width: 100%;" />
                                            </p>
                                        </ol>
                                    </div>
                                    <p class="FooterTop"><a href="../../en-US/Fireware/support/doc_feedback.html">Give Us Feedback</a>&#160;&#160;●&#160;&#160;
            <a href="../../en-US/Fireware/support/getsupport.html">Get Support</a>&#160;&#160;●&#160;&#160;
            <a href="https://www.watchguard.com/wgrd-help/documentation/overview" target="_blank">All Product Documentation</a>&#160;&#160;●&#160;&#160;
            <a href="https://techsearch.watchguard.com/" target="_blank">Technical Search</a></p>
                                    <p class="Footer">© <span class="mc-variable Global.CurrentYear variable">2024</span> WatchGuard Technologies, Inc. All rights reserved. WatchGuard and the WatchGuard logo are registered trademarks or trademarks of WatchGuard Technologies in the United States and other countries. Various other trademarks are held by their respective owners.</p>
                                    <p class="Footer">&#160;</p>
                                    <div id="expand-collapse" title="Expand/collapse navigation" class="collapse">
                                    </div>
                                    <script src="../../Resources/MasterPages/scripts/expand-collapse.js">
                                    </script>
                                    <script src="../../Resources/MasterPages/scripts/cover-hide.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>