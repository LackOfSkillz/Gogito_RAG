<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Help_Center_Side_Nav" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-toc-path="Self-Help Tools|Integration Guides|Endpoint Security" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Expires" content="3600" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="120x120" href="../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" /><title>Splunk  Integration Guide — WatchGuard EPDR or Panda Adaptive Defense 360</title>
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/help_(en-US).css" rel="stylesheet" type="text/css" />
        <link rel="apple-touch-icon" sizes="120x120" href="../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-T3SCZC3');/* ]]> */</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-left" role="navigation" id="offCanvas" data-off-canvas="" data-position="left" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 979px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../en-US/_intro/home.html" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div id="cover">
                                    </div>
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T3SCZC3" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="6" data-mc-toc="True"><span class="MCBreadcrumbsPrefix"> </span>
                                        </div>
                                    </div>
                                    <div role="main" id="mc-main-content">
                                        <h1><a name="aanchor2808"></a>
                                            <MadCap:concept term="Self-Help Tools" />Splunk  Integration Guide — WatchGuard EPDR or Panda Adaptive Defense 360</h1>
                                        <p class="Note">WatchGuard provides integration instructions to help customers configure WatchGuard products to work with products created by other organizations. If you need more information or technical support about how to configure a third-party product, go to the documentation and support resources for that product.</p>
                                        <h2>Integration Overview</h2>
                                        <p>This document describes how to integrate Splunk with WatchGuard EPDR or Panda Adaptive Defense 360 so that a Splunk administrator can view information from endpoint telemetry and alerts.</p>
                                        <h2>Platform and Software</h2>
                                        <p>The hardware and software used to complete the steps outlined in this document include:</p>
                                        <ul>
                                            <li>WatchGuard EPDR or Panda Adaptive Defense 360 with a SIEMFeeder license</li>
                                            <li>Splunk Enterprise 9.0</li>
                                            <li>Splunk Universal Forwarder</li>
                                            <li>WatchGuard Endpoint Add-on for Splunk Version 1.0</li>
                                            <li>WatchGuard Visibility App for Splunk Version 1.0</li>
                                        </ul>
                                        <h2>Integration Topology</h2>
                                        <p>This diagram shows the topology used in the integration. In this diagram, the Splunk Enterprise deployment can be either a locally-managed Splunk installation or a Splunk Cloud deployment.</p>
                                        <p>
                                            <img src="_images/splunk-epdr-ad360-topology.png" />
                                        </p>
                                        <h2>Configure the SIEMFeeder Event Importer for WatchGuard EPDR or Adaptive Defense 360</h2>
                                        <p>To install and configure the SIEMFeeder Event Importer, complete the steps in the <a href="https://www.watchguard.com/help/docs/help-center/en-US/Content/en-US/Endpoint-Security/security-modules/siemfeeder/siemfeeder-install-config.html" target="_blank">Configure and Run Event Importer</a> Endpoint Security Help topic. Make sure to configure the Event Importer to deliver logs to a local file on disk. For example, <span class="Input">/var/log/epdr/</span>. </p>
                                        <p class="BestPractice">To make sure that log files are rotated before you reach your maximum allocated storage on the Event Importer server, we recommend that you use the <b>directoryMaxSizeInMB</b> configuration option in the Event Importer settings <span class="Input">configuration.json</span> file.</p>
                                        <h2>Splunk Enterprise Configuration</h2>
                                        <p>To configure Splunk Enterprise, complete these steps:</p>
                                        <ol>
                                            <li value="1"><a href="#Configur" class="MCXref xref">Add an Index to Splunk Enterprise</a>.</li>
                                            <li value="2"><a href="#Install" class="MCXref xref">Configure the Splunk Universal Forwarder</a>.</li>
                                        </ol>
                                        <h3><a name="Configur"></a>Add an Index to Splunk Enterprise</h3>
                                        <p>To add an index to Splunk Enterprise:</p>
                                        <ol>
                                            <li value="1">Select <b>Settings &gt; Indexes</b>, then click <b>New Index</b>.</li>
                                            <li value="2">Enter an <b>Index Name</b>.<br />You can enter any name for the index. We recommend that you use the index <span class="Input">endpoint</span> to store WatchGuard EPDR and Adaptive Defense 360 events on your Splunk server. In this guide, we refer to the index name <span class="Input">endpoint</span>. </li>
                                            <li value="3">Accept the default values in the dialog box, or enter values, as required for your implementation.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="_images/splunk-endpoint-index-configuration.png" />
                                        </p>
                                        <ol data-mc-continue="true">
                                            <li value="4">Click <b>Save</b>.</li>
                                        </ol>
                                        <h3><a name="Install"></a>Configure the Splunk Universal Forwarder</h3>
                                        <p>After you add the index, download and install the <a href="https://www.splunk.com/en_us/blog/learn/splunk-universal-forwarder.html" target="_blank">Splunk Universal Forwarder</a> on the same server where you configured the SIEMFeeder Event Importer. </p>
                                        <p>To configure the Splunk Universal Forwarder:</p>
                                        <ol>
                                            <li value="1">Connect the Splunk Universal Forwarder to the Splunk Enterprise server. <br />For information on how to connect the Universal Forwarder to your Splunk Enterprise server as a data input source, go to the <a href="https://docs.splunk.com/Documentation/Forwarder/9.0.3/Forwarder/Abouttheuniversalforwarder">Splunk documentation</a>.</li>
                                            <li value="2">In the file, <span class="Input">%splunkhome%/etc/system/local/inputs.conf</span>, where <span class="Input">%splunkhome%</span> is the installation location for the Universal Forwarder, add this text: </li>
                                        </ol>
                                        <p class="BodyIndent"><span class="Input">[monitor:///var/log/epdr/*]</span>
                                        </p>
                                        <p class="BodyIndent"><span class="Input">disabled = 0</span>
                                        </p>
                                        <p class="BodyIndent"><span class="Input">index = endpoint</span>
                                        </p>
                                        <p class="BodyIndent"><span class="Input">sourcetype = watchguard:endpoint:log</span>
                                        </p>
                                        <ol data-mc-continue="true">
                                            <li value="3">Replace <span class="Input">/var/log/epdr/</span> with the log directory you configured in the Event Importer configuration. </li>
                                        </ol>
                                        <ol data-mc-continue="true">
                                            <li value="4">Restart the Splunk Universal Forwarder application.</li>
                                        </ol>
                                        <h2>Install the WatchGuard Visibility App for Splunk</h2>
                                        <p>To install the WatchGuard Visibility app for Splunk:</p>
                                        <ol>
                                            <li value="1">Log in to Splunk Enterprise.</li>
                                            <li value="2">From the <b>Apps</b> menu, select <b>Manage Apps</b>.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="../General/_images/splunk/Manage Apps.png" style="max-height: auto;max-width: 100%;" alt="Screen shot of the splunk&gt;enterprise Apps &gt; Manage Apps menu" />
                                        </p>
                                        <ol data-mc-continue="true">
                                            <li value="3">To browse the apps available from Splunkbase, click <b>Browse More Apps</b>.</li>
                                            <li value="4">In Splunkbase, search for WatchGuard apps.</li>
                                            <li value="5">Install the WatchGuard Endpoint Add-on for Splunk and the WatchGuard Visibility App for Splunk.</li>
                                            <li value="6">Click <b>Restart Now</b>, then confirm that you want to restart.</li>
                                        </ol>
                                        <p class="img_indent_1">
                                            <img src="../General/_images/splunk/Restart.png" style="max-width: 90%;max-height: auto;" />
                                        </p>
                                        <h2>Test the Integration</h2>
                                        <p>After the Universal Forwarder sends WatchGuard EPDR or Adaptive Defense 360 logs to Splunk, you can review endpoint information in the WatchGuard Visibility App for Splunk. You can also search the endpoint index for event data.</p>
                                        <p>In the WatchGuard Visibility App for Splunk, you can review data from WatchGuard EPDR and Adaptive Defense 360 on the main dashboard or you can select  <b>Endpoint Dashboard</b> from the <b>Endpoint </b>menu.</p>
                                        <p>
                                            <img src="_images/splunk-endpoint-dashboard.png" alt="Screen shot of Splunk Endpoint dashboard" />
                                        </p>
                                    </div>
                                    <p class="FooterTop"><a href="../../en-US/Fireware/support/doc_feedback.html">Give Us Feedback</a>&#160;&#160;●&#160;&#160;
            <a href="../../en-US/Fireware/support/getsupport.html">Get Support</a>&#160;&#160;●&#160;&#160;
            <a href="https://www.watchguard.com/wgrd-help/documentation/overview" target="_blank">All Product Documentation</a>&#160;&#160;●&#160;&#160;
            <a href="https://techsearch.watchguard.com/" target="_blank">Technical Search</a></p>
                                    <p class="Footer">© <span class="mc-variable Global.CurrentYear variable">2024</span> WatchGuard Technologies, Inc. All rights reserved. WatchGuard and the WatchGuard logo are registered trademarks or trademarks of WatchGuard Technologies in the United States and other countries. Various other trademarks are held by their respective owners.</p>
                                    <p class="Footer">&#160;</p>
                                    <div id="expand-collapse" title="Expand/collapse navigation" class="collapse">
                                    </div>
                                    <script src="../../Resources/MasterPages/scripts/expand-collapse.js">
                                    </script>
                                    <script src="../../Resources/MasterPages/scripts/cover-hide.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>